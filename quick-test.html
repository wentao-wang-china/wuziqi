<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>å¿«é€Ÿæµ‹è¯• - èµ›åšæœ‹å…‹äº”å­æ£‹</title>
    <style>
        body {
            font-family: monospace;
            padding: 20px;
            background: #0a0e27;
            color: #00f3ff;
        }
        .test-result {
            margin: 10px 0;
            padding: 10px;
            border-left: 3px solid #00f3ff;
        }
        .pass { border-color: #39ff14; color: #39ff14; }
        .fail { border-color: #ff006e; color: #ff006e; }
        button {
            background: #00f3ff;
            color: #0a0e27;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            cursor: pointer;
            font-weight: bold;
        }
        button:hover {
            background: #39ff14;
        }
    </style>
</head>
<body>
    <h1>ğŸ§ª äº”å­æ£‹å¿«é€Ÿæµ‹è¯•</h1>

    <div id="results"></div>

    <button onclick="runAllTests()">è¿è¡Œæ‰€æœ‰æµ‹è¯•</button>
    <button onclick="location.href='index.html'">æ‰“å¼€æ¸¸æˆ</button>

    <!-- åŠ è½½æ‰€æœ‰JSæ–‡ä»¶ -->
    <script src="js/utils.js"></script>
    <script src="js/audio.js"></script>
    <script src="js/board.js"></script>
    <script src="js/ai.js"></script>
    <script src="js/game.js"></script>

    <script>
        const results = document.getElementById('results');

        function log(message, pass = true) {
            const div = document.createElement('div');
            div.className = `test-result ${pass ? 'pass' : 'fail'}`;
            div.textContent = `${pass ? 'âœ…' : 'âŒ'} ${message}`;
            results.appendChild(div);
            console.log(message);
        }

        function runAllTests() {
            results.innerHTML = '';
            log('=== å¼€å§‹æµ‹è¯• ===');

            // æµ‹è¯•1: å·¥å…·å‡½æ•°
            try {
                const opponent = getOpponent(CONSTANTS.PLAYER_BLACK);
                if (opponent === CONSTANTS.PLAYER_WHITE) {
                    log('æµ‹è¯•1: getOpponent å‡½æ•°æ­£å¸¸');
                } else {
                    log('æµ‹è¯•1: getOpponent å‡½æ•°å¤±è´¥', false);
                }
            } catch (e) {
                log(`æµ‹è¯•1: é”™è¯¯ - ${e.message}`, false);
            }

            // æµ‹è¯•2: æ£‹ç›˜åˆ›å»º
            try {
                const board = new Board(15);
                board.initGrid();
                if (board.grid.length === 15 && board.grid[0].length === 15) {
                    log('æµ‹è¯•2: æ£‹ç›˜åˆ›å»ºæˆåŠŸ (15x15)');
                } else {
                    log('æµ‹è¯•2: æ£‹ç›˜å¤§å°é”™è¯¯', false);
                }
            } catch (e) {
                log(`æµ‹è¯•2: é”™è¯¯ - ${e.message}`, false);
            }

            // æµ‹è¯•3: æ¸¸æˆå¼•æ“
            try {
                const game = new Game();
                if (game.currentPlayer === CONSTANTS.PLAYER_BLACK) {
                    log('æµ‹è¯•3: æ¸¸æˆå¼•æ“åˆ›å»ºæˆåŠŸ');
                } else {
                    log('æµ‹è¯•3: åˆå§‹ç©å®¶é”™è¯¯', false);
                }
            } catch (e) {
                log(`æµ‹è¯•3: é”™è¯¯ - ${e.message}`, false);
            }

            // æµ‹è¯•4: AIå¼•æ“
            try {
                const ai = new AI('medium', CONSTANTS.PLAYER_WHITE);
                if (ai.maxDepth === 2 && ai.player === CONSTANTS.PLAYER_WHITE) {
                    log('æµ‹è¯•4: AIå¼•æ“åˆ›å»ºæˆåŠŸ (ä¸­ç­‰éš¾åº¦, æ·±åº¦2)');
                } else {
                    log('æµ‹è¯•4: AIé…ç½®é”™è¯¯', false);
                }
            } catch (e) {
                log(`æµ‹è¯•4: é”™è¯¯ - ${e.message}`, false);
            }

            // æµ‹è¯•5: äº”è¿åˆ¤å®š
            try {
                const game = new Game();
                const board = new Board(15);
                board.initGrid();

                // åˆ›å»ºæ¨ªå‘äº”è¿
                for (let i = 0; i < 5; i++) {
                    board.grid[7][i] = CONSTANTS.PLAYER_BLACK;
                }

                if (game.checkWin(7, 2, CONSTANTS.PLAYER_BLACK)) {
                    log('æµ‹è¯•5: æ¨ªå‘äº”è¿åˆ¤å®šæˆåŠŸ');
                } else {
                    log('æµ‹è¯•5: äº”è¿åˆ¤å®šå¤±è´¥', false);
                }
            } catch (e) {
                log(`æµ‹è¯•5: é”™è¯¯ - ${e.message}`, false);
            }

            // æµ‹è¯•6: AIå€™é€‰ç‚¹ç”Ÿæˆ
            try {
                const board = new Board(15);
                board.initGrid();
                board.grid[7][7] = CONSTANTS.PLAYER_BLACK;
                board.history.push({row: 7, col: 7, player: CONSTANTS.PLAYER_BLACK});

                const ai = new AI('easy', CONSTANTS.PLAYER_WHITE);
                const candidates = ai.getCandidateMoves(board);

                if (candidates.length > 0 && candidates.length <= 20) {
                    log(`æµ‹è¯•6: å€™é€‰ç‚¹ç”ŸæˆæˆåŠŸ (${candidates.length}ä¸ªå€™é€‰ç‚¹)`);
                } else {
                    log('æµ‹è¯•6: å€™é€‰ç‚¹æ•°é‡å¼‚å¸¸', false);
                }
            } catch (e) {
                log(`æµ‹è¯•6: é”™è¯¯ - ${e.message}`, false);
            }

            // æµ‹è¯•7: AIè¯„ä¼°å‡½æ•°
            try {
                const board = new Board(15);
                board.initGrid();

                // åˆ›å»ºä¸‰è¿
                board.grid[7][5] = CONSTANTS.PLAYER_BLACK;
                board.grid[7][6] = CONSTANTS.PLAYER_BLACK;
                board.grid[7][7] = CONSTANTS.PLAYER_BLACK;

                const ai = new AI('easy', CONSTANTS.PLAYER_WHITE);
                const pattern = ai.getPattern(board, 7, 6, 0, 1, CONSTANTS.PLAYER_BLACK);

                if (pattern.count >= 3) {
                    log(`æµ‹è¯•7: è¿å­æ¨¡å¼è¯†åˆ«æˆåŠŸ (è¯†åˆ«åˆ°${pattern.count}è¿)`);
                } else {
                    log('æµ‹è¯•7: æ¨¡å¼è¯†åˆ«å¤±è´¥', false);
                }
            } catch (e) {
                log(`æµ‹è¯•7: é”™è¯¯ - ${e.message}`, false);
            }

            // æµ‹è¯•8: éŸ³æ•ˆç®¡ç†å™¨
            try {
                const audioMgr = new AudioManager();
                if (audioMgr.enabled === true) {
                    log('æµ‹è¯•8: éŸ³æ•ˆç®¡ç†å™¨åˆ›å»ºæˆåŠŸ');
                } else {
                    log('æµ‹è¯•8: éŸ³æ•ˆç®¡ç†å™¨çŠ¶æ€é”™è¯¯', false);
                }
            } catch (e) {
                log(`æµ‹è¯•8: é”™è¯¯ - ${e.message}`, false);
            }

            log('=== æµ‹è¯•å®Œæˆ ===');
        }

        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨è¿è¡Œæµ‹è¯•
        window.addEventListener('DOMContentLoaded', () => {
            console.log('å¿«é€Ÿæµ‹è¯•é¡µé¢åŠ è½½å®Œæˆ');
            runAllTests();
        });
    </script>
</body>
</html>
